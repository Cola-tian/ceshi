"use strict";(self["webpackChunkhmmm_frontend_vue3_dev"]=self["webpackChunkhmmm_frontend_vue3_dev"]||[]).push([[99,979,473],{8720:function(e,t,a){a.d(t,{IH:function(){return r},Od:function(){return o},Vx:function(){return l},lA:function(){return d},lC:function(){return n},pb:function(){return s}});var i=a(84471);const s=e=>(0,i.r)("/permissions","get",e),n=e=>(0,i.r)("/permissions/simple","get",e),r=e=>(0,i.r)("/permissions","post",e),l=e=>(0,i.r)(`/permissions/${e.id}`,"put",e),o=e=>(0,i.r)(`/permissions/${e.id}`,"delete",e),d=e=>(0,i.r)(`/permissions/${e.id}`,"get",e)},8979:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=a(73396);const s={class:"pages"};function n(e,t,a,n,r,l){const o=(0,i.up)("el-pagination");return(0,i.wg)(),(0,i.iD)("div",s,[(0,i.Wm)(o,{background:"",onSizeChange:l.onPageSizeChange,onCurrentChange:l.onPageChange,"current-page":Number(a.paginationPage),total:Number(a.total),"page-size":Number(a.paginationPagesize),"page-sizes":[10,20,30,50],layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","current-page","total","page-size"])])}var r=a(19471),l={name:"PageTool",props:["total","paginationPage","paginationPagesize"],data(){return{}},methods:{onPageChange:function(e){(0,r.Qy)(this,"pageChange",e)},onPageSizeChange:function(e){(0,r.Qy)(this,"pageSizeChange",e)}},emits:["pageChange","pageSizeChange"]},o=a(40089);const d=(0,o.Z)(l,[["render",n]]);var m=d},39473:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var i=a(73396),s=a(87139);const n={class:"add-form"},r={class:"dialog-footer"};function l(e,t,a,l,o,d){const m=(0,i.up)("el-input"),h=(0,i.up)("el-form-item"),u=(0,i.up)("el-tree"),c=(0,i.up)("el-form"),p=(0,i.up)("el-button"),g=(0,i.up)("el-dialog");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(g,{title:a.text+a.pageTitle,modelValue:o.dialogFormVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>o.dialogFormVisible=e)},{footer:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i.Wm)(p,{onClick:d.handleClose},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.$t("table.cancel")),1)])),_:1},8,["onClick"]),(0,i.Wm)(p,{type:"primary",onClick:t[1]||(t[1]=e=>d.handleAdd("formBase"))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e.$t("table.confirm")),1)])),_:1})])])),default:(0,i.w5)((()=>[(0,i.Wm)(c,{rules:a.ruleInline,ref:"dataForm",model:o.formBase,"label-position":"left","label-width":"120px",style:{width:"400px","margin-left":"120px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:e.$t("table.username"),prop:"title"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{modelValue:o.formBase.title,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formBase.title=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.Wm)(h,{label:e.$t("table.powerDistriB")},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{ref:"treeMenu",data:d.treeData,"show-checkbox":"","node-key":"id","default-expanded-keys":[0],"default-checked-keys":o.formBase.permissions,props:o.defaultProps,onCheck:d.handleCheckChange},null,8,["data","default-checked-keys","props","onCheck"])])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])])}a(57658);var o=a(19471),d=a(8720),m=a(5917);let h=[];var u={name:"usersAdd",props:["text","pageTitle","ruleInline"],data(){return{dialogFormVisible:!1,PermissionGroupsmenu:[],defaultProps:{label:"title"},permissions:[],treeCheckedNodes:[],formBase:{id:0,create_date:"",title:"",permissions:[]},curPermissions:[]}},computed:{treeData(){function e(e){let t=!1,a=!1;if(null!==h&&h.formBase.permissions.length>0){const t=h.formBase.permissions.find((function(t,a){return t===e.id}));a=!!t}if(a){const a=void 0===e.childs&&void 0===e.points,i=void 0!==e.childs&&e.childs.length>0,s=void 0!==e.points&&e.points.length>0;t=!!a||!s&&!i}return{id:void 0===e.id?0:e.id,title:e.title,children:[],selected:a,checked:t}}function t(a,i){for(const s of a){const a=e(s);a.checked&&(i.selected=!0),void 0!==s.childs&&s.childs.length>0?t(s.childs,a):void 0!==s.points&&s.points.length>0&&t(s.points,a),i.children.push(a)}}const a=e({title:"系统菜单和页面权限点",expand:!0});return t(this.PermissionGroupsmenu,a),[a]}},methods:{dialogFormV(){this.dialogFormVisible=!0},dialogFormH(){this.dialogFormVisible=!1},handleClose(){(0,o.Qy)(this,"handleCloseModal")},handleResetForm(){this.formBase={id:0,title:"",permissions:[]}},hanldeEditForm(e){this.formBase.id=e;const t={id:e};(0,d.lA)(t).then(((e,t)=>{if(t)return t;this.formBase.id=e.data.id,this.formBase.title=e.data.title,this.formBase.permissions=e.data.permissions}))},setupData(){(0,m.pb)().then((e=>{this.PermissionGroupsmenu=e.data}))},handleCheckChange(e,t,a){this.treeCheckedNodes=t.checkedNodes},handleAdd(e){const t=new Set;if(0!==this.treeCheckedNodes.length||(this.treeCheckedNodes=this.$refs.treeMenu.getCheckedNodes(),0!==this.treeCheckedNodes.length)){for(const e of this.treeCheckedNodes)t.add(e.id);this.curPermissions=Array.from(t),0===this.curPermissions.length?this.$message({showClose:!0,message:"请选择需要的权限及页面权限点",type:"error"}):this.dataFormSub(this.curPermissions)}},nodeDate(e,t,a){e.forEach((function(e,i){-1===t.indexOf(e.id)&&t.push(a)}))},dataFormSub(e){this.$refs.dataForm.validate((t=>{if(t)if((0,o.Qy)(this,"handleCloseModal"),h.formBase.id){const t={id:this.formBase.id,title:this.formBase.title,permissions:e};(0,d.Vx)(t).then((()=>{(0,o.Qy)(this,"newDataes",this.formBase)}))}else(0,d.IH)({title:this.formBase.title,permissions:e}).then((()=>{(0,o.Qy)(this,"newDataes",this.formBase)}));else this.$Message.error("*号为必填项!")}))}},mounted:function(){},created(){h=this,this.setupData()},updated:function(){},emits:["newDataes","handleCloseModal"]},c=a(40089);const p=(0,c.Z)(u,[["render",l]]);var g=p},5099:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var i=a(73396),s=a(49242),n=a(87139);const r={class:"dashboard-container"},l={class:"app-container"},o={class:"pagination"};function d(e,t,a,d,m,h){const u=(0,i.up)("el-input"),c=(0,i.up)("el-button"),p=(0,i.up)("el-form-item"),g=(0,i.up)("el-form"),f=(0,i.up)("el-alert"),w=(0,i.up)("el-table-column"),C=(0,i.up)("el-table"),P=(0,i.up)("PageTool"),b=(0,i.up)("el-card"),k=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",l,[(0,i.Wm)(b,{shadow:"never"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{model:m.requestParameters,ref:"requestParameters"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{prop:"title"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{onKeyup:(0,s.D2)(h.handleFilter,["enter"]),style:{width:"200px"},placeholder:e.$t("table.search"),class:"filter-item",modelValue:m.requestParameters.title,"onUpdate:modelValue":t[0]||(t[0]=e=>m.requestParameters.title=e)},null,8,["onKeyup","placeholder","modelValue"]),(0,i.Wm)(c,{class:"filter-item",size:"small",type:"primary",icon:m.ElIconSearch,onClick:h.handleFilter},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("table.search")),1)])),_:1},8,["icon","onClick"]),(0,i.Wm)(c,{class:"filter-item",size:"small",type:"primary",onClick:h.resetForm},{default:(0,i.w5)((()=>[(0,i.Uk)("重置")])),_:1},8,["onClick"])])),_:1}),(0,i.Wm)(c,{class:"filter-item fr",size:"small",style:{"margin-left":"10px"},onClick:h.handleCreate,type:"primary",icon:m.ElIconEdit},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("table.permissionNew")),1)])),_:1},8,["onClick","icon"])])),_:1},8,["model"]),""!==m.alertText?((0,i.wg)(),(0,i.j4)(f,{key:0,title:m.alertText,type:"info",class:"alert",closable:!1,"show-icon":""},null,8,["title"])):(0,i.kq)("",!0),(0,i.wy)(((0,i.wg)(),(0,i.j4)(C,{key:m.tableKey,data:m.dataList,"element-loading-text":"给我一点时间",fit:"","highlight-current-row":"",style:{width:"100%"},border:""},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{type:"selection",width:"55"}),(0,i.Wm)(w,{align:"center",label:e.$t("table.username")},{default:(0,i.w5)((e=>[(0,i._)("span",null,(0,n.zw)(e.row.title),1)])),_:1},8,["label"]),(0,i.Wm)(w,{label:e.$t("table.date"),"sort-method":h.changesort,sortable:""},{default:(0,i.w5)((t=>[(0,i._)("span",null,(0,n.zw)(e.$filters.parseTimeByString(t.row.create_date,"{y}-{m}-{d}")),1)])),_:1},8,["label","sort-method"]),(0,i.Wm)(w,{align:"center",label:e.$t("table.actions"),"class-name":"small-padding fixed-width"},{default:(0,i.w5)((t=>[(0,i.Wm)(c,{type:"primary",size:"mini",onClick:e=>h.handleUpdate(t.row.id)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("table.edit")),1)])),_:2},1032,["onClick"]),"deleted"!=t.row.status?((0,i.wg)(),(0,i.j4)(c,{key:0,size:"mini",type:"danger",onClick:e=>h.removeUser(t.row.id)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("table.delete")),1)])),_:2},1032,["onClick"])):(0,i.kq)("",!0)])),_:1},8,["label"])])),_:1},8,["data"])),[[k,m.listLoading]]),(0,i._)("div",o,[(0,i.Wm)(P,{paginationPage:m.requestParameters.page,paginationPagesize:m.requestParameters.pagesize,total:m.total,onPageChange:h.handleCurrentChange,onPageSizeChange:h.handleSizeChange},null,8,["paginationPage","paginationPagesize","total","onPageChange","onPageSizeChange"])]),((0,i.wg)(),(0,i.j4)((0,i.LL)(m.PermissionsAdd),{ref:"editPermission",formData:m.requestParameters,"onUpdate:formData":t[1]||(t[1]=e=>m.requestParameters=e),text:m.text,pageTitle:m.pageTitle,ruleInline:m.ruleInline,onNewDataes:h.handleLoadDataList,onHandleCloseModal:h.handleCloseModal},null,40,["formData","text","pageTitle","ruleInline","onNewDataes","onHandleCloseModal"]))])),_:1})])])}var m=a(72748),h=a(8720),u=a(8979),c=a(39473),p={data(){return{PermissionsAdd:"PermissionsAdd",permissionsApiAdd:"permissionsApiAdd",pageTitle:"权限组",text:"",apiTitle:"高级接口授权",tableKey:0,dataList:[],total:null,listLoading:!0,dialogStatus:"",alertText:"",requestParameters:{page:1,pagesize:10,title:this.title},ruleInline:{title:[{required:!0,message:"用户名不能为空",trigger:"blur"}]},ElIconSearch:m.Search,ElIconEdit:m.Edit}},name:"base-permissions",components:{PermissionsAdd:c["default"],PageTool:u["default"]},computed:{},methods:{getList(e){this.listLoading=!0,(0,h.pb)(this.requestParameters).then((e=>{this.dataList=e.data.list,this.total=e.data.counts,this.alertText=`共 ${this.total} 条记录`,this.listLoading=!1})).catch((e=>{this.$message.e("错了哦，这是一条错误消息")}))},changesort(e,t){const a=new Date(e.date).getTime()/1e3,i=new Date(t.date).getTime()/1e3;return a-i>0},resetForm(){this.$refs.requestParameters.resetFields()},handleFilter(){this.requestParameters.page=1,this.getList(this.requestParameters)},handleSizeChange(e){this.requestParameters.pagesize=e,1===this.requestParameters.page&&this.getList(this.requestParameters)},handleCurrentChange(e){this.requestParameters.page=e,this.getList()},handleLoadDataList(){this.getList()},handleCreate(){this.text="创建",this.$refs.editPermission.handleResetForm(),this.$refs.editPermission.dialogFormV()},handleCloseModal(){this.$refs.editPermission.dialogFormH()},handleUpdate(e){this.text="编辑",this.$refs.editPermission.dialogFormV(),this.$refs.editPermission.hanldeEditForm(e)},removeUser(e){this.$confirm("此操作将永久删除用户 , 是否继续?","提示",{type:"warning"}).then((()=>{(0,h.Od)({id:e}).then((t=>{this.$message.success("成功删除了用户!"),this.dataList.splice(e,1),this.getList(this.requestParameters)})).catch((e=>{this.$message.error("删除失败!")}))})).catch((()=>{this.$message.info("已取消操作!")}))},handleApiSet(e){this.$refs.editPermissionApi.dialogFormV()}},mounted:function(){},created(){this.getList();const e=this;document.onkeydown=function(t){const a=window.event.keyCode;13===a&&e.handleFilter(this.requestParameters)}},updated:function(){}},g=a(40089);const f=(0,g.Z)(p,[["render",d],["__scopeId","data-v-04c0be96"]]);var w=f}}]);
//# sourceMappingURL=99.0a45e2bd.js.map