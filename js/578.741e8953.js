"use strict";(self["webpackChunkhmmm_frontend_vue3_dev"]=self["webpackChunkhmmm_frontend_vue3_dev"]||[]).push([[578,483],{18483:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var l=a(73396),i=a(87139),s=a(49242);const r={class:"add-form"},n=(0,l._)("p",null,"https://www.tianyancha.com （在此可查询所属公司全称及简称）",-1),o={class:"dialog-footer"};function u(e,t,a,u,m,d){const c=(0,l.up)("el-input"),p=(0,l.up)("el-checkbox"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-option"),g=(0,l.up)("el-select"),w=(0,l.up)("el-form"),y=(0,l.up)("el-button"),b=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(b,{title:a.titleInfo.text+a.titleInfo.pageTitle,modelValue:m.dialogFormVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>m.dialogFormVisible=e)},{footer:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(y,{onClick:d.dialogFormH},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.$t("table.cancel")),1)])),_:1},8,["onClick"]),(0,l.Wm)(y,{type:"primary",onClick:d.createData},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.$t("table.confirm")),1)])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(w,{rules:m.ruleInline,ref:"dataForm",model:a.formBase,"label-position":"left","label-width":"150px",style:{width:"80%","margin-left":"10px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"企业名称",prop:"shortName"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:a.formBase.shortName,"onUpdate:modelValue":t[0]||(t[0]=e=>a.formBase.shortName=e)},null,8,["modelValue"]),(0,l.Wm)(p,{modelValue:a.formBase.isFamous,"onUpdate:modelValue":t[1]||(t[1]=e=>a.formBase.isFamous=e)},{default:(0,l.w5)((()=>[(0,l.Uk)("是否为名企")])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(h,{label:"所属公司",prop:"company"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:a.formBase.company,"onUpdate:modelValue":t[2]||(t[2]=e=>a.formBase.company=e)},null,8,["modelValue"]),n])),_:1}),(0,l.Wm)(h,{label:"城市",prop:"province"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"filter-item",style:{width:"130px"},modelValue:a.formBase.province,"onUpdate:modelValue":t[3]||(t[3]=e=>a.formBase.province=e),onKeyup:(0,s.D2)(e.handleFilter,["enter"]),onChange:d.handleProvince,filterable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.citySelect.province,(e=>((0,l.wg)(),(0,l.j4)(f,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onKeyup","onChange"]),(0,l.Wm)(g,{class:"filter-item",style:{width:"130px"},modelValue:a.formBase.city,"onUpdate:modelValue":t[4]||(t[4]=e=>a.formBase.city=e),onKeyup:(0,s.D2)(e.handleFilter,["enter"]),filterable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.citySelect.cityDate,(e=>((0,l.wg)(),(0,l.j4)(f,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onKeyup"])])),_:1}),(0,l.Wm)(h,{label:"方向（企业标签）",prop:"tags"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:a.formBase.tags,"onUpdate:modelValue":t[5]||(t[5]=e=>a.formBase.tags=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(h,{label:"备注",prop:"remarks"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入",modelValue:a.formBase.remarks,"onUpdate:modelValue":t[6]||(t[6]=e=>a.formBase.remarks=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])])}var m=a(19471),d=a(59790),c=a(25732),p={name:"CompanysAdd",props:{titleInfo:{type:Object,required:!0},formBase:{type:Object,required:!0}},data(){return{dialogFormVisible:!1,citySelect:{province:[],cityDate:[]},ruleInline:{shortName:[{required:!0,message:"企业简称不能为空",trigger:"blur"}],province:[{required:!0,message:"请选择省份",trigger:"change"}],tags:[{required:!0,message:"请请输标签",trigger:"blur"}]}}},computed:{},methods:{dialogFormV(){this.dialogFormVisible=!0},dialogFormH(){this.dialogFormVisible=!1},getCityData:function(){this.citySelect.province=(0,c.J)()},handleProvince:function(e){this.citySelect.cityDate=(0,c.s)(e),this.formBase.city=this.citySelect.cityDate[0]},createData(){this.$refs.dataForm.validate((async e=>{if(e){this.dialogFormH();const e={...this.formBase};this.formBase.id?await(0,d.Vx)(e).then((()=>{(0,m.Qy)(this,"newDataes",this.formBase)})):await(0,d.IH)(this.formBase).then((()=>{(0,m.Qy)(this,"newDataes",this.formBase)}))}else this.$message.error("*号为必填项!")}))}},mounted:function(){},created(){this.getCityData()},updated:function(){},emits:["newDataes"]},h=a(40089);const f=(0,h.Z)(p,[["render",u]]);var g=f},12578:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var l=a(73396),i=a(49242),s=a(87139);const r={class:"dashboard-container"},n={class:"app-container"},o={class:"filter-container"},u={key:0},m={key:1},d={key:0},c={key:1},p={class:"pagination"},h={class:"pages"};function f(e,t,a,f,g,w){const y=(0,l.up)("el-input"),b=(0,l.up)("el-form-item"),_=(0,l.up)("el-col"),v=(0,l.up)("el-option"),W=(0,l.up)("el-select"),k=(0,l.up)("el-button"),D=(0,l.up)("el-row"),V=(0,l.up)("el-form"),C=(0,l.up)("el-alert"),q=(0,l.up)("el-table-column"),P=(0,l.up)("el-table"),F=(0,l.up)("el-pagination"),z=(0,l.up)("Dialog"),x=(0,l.up)("el-card"),B=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",n,[(0,l.Wm)(x,{shadow:"never"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{model:g.requestParameters,ref:"requestParameters"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(D,{gutter:20},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:5},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"标签名称：",prop:"tags"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{onKeyup:(0,i.D2)(w.handleFilter,["enter"]),style:{width:"180px"},placeholder:"请输入",class:"filter-item",modelValue:g.requestParameters.tags,"onUpdate:modelValue":t[0]||(t[0]=e=>g.requestParameters.tags=e)},null,8,["onKeyup","modelValue"])])),_:1})])),_:1}),(0,l.Wm)(_,{span:3},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"省：",prop:"province"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"filter-item",style:{width:"120px"},modelValue:g.requestParameters.province,"onUpdate:modelValue":t[1]||(t[1]=e=>g.requestParameters.province=e),onKeyup:(0,i.D2)(w.handleFilter,["enter"]),onChange:w.handleProvince,filterable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.citySelect.province,(e=>((0,l.wg)(),(0,l.j4)(v,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onKeyup","onChange"])])),_:1})])),_:1}),(0,l.Wm)(_,{span:3},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"市：",prop:"city"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"filter-item",style:{width:"120px"},modelValue:g.requestParameters.city,"onUpdate:modelValue":t[2]||(t[2]=e=>g.requestParameters.city=e),onKeyup:(0,i.D2)(w.handleFilter,["enter"]),filterable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.citySelect.cityDate,(e=>((0,l.wg)(),(0,l.j4)(v,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onKeyup"])])),_:1})])),_:1}),(0,l.Wm)(_,{span:5},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"企业简称：",prop:"shortName"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{modelValue:g.requestParameters.shortName,"onUpdate:modelValue":t[3]||(t[3]=e=>g.requestParameters.shortName=e),style:{width:"180px"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(_,{span:3},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"状态：",prop:"state"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"filter-item",style:{width:"100px"},modelValue:g.requestParameters.state,"onUpdate:modelValue":t[4]||(t[4]=e=>g.requestParameters.state=e),onKeyup:(0,i.D2)(w.handleFilter,["enter"])},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.status,(e=>((0,l.wg)(),(0,l.j4)(v,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onKeyup"])])),_:1})])),_:1}),(0,l.Wm)(_,{span:2},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{label:"操作："},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{size:"small",type:"primary",icon:g.ElIconSearch,onClick:w.handleFilter},{default:(0,l.w5)((()=>[(0,l.Uk)("搜索")])),_:1},8,["icon","onClick"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(k,{class:"filter-item fr",size:"small",style:{"margin-left":"10px"},onClick:t[5]||(t[5]=e=>w.handleChange("add")),type:"primary",icon:g.ElIconEdit},{default:(0,l.w5)((()=>[(0,l.Uk)("新增用户")])),_:1},8,["icon"])])])),_:1},8,["model"]),""!==g.alertText?((0,l.wg)(),(0,l.j4)(C,{key:0,title:g.alertText,type:"info",class:"alert",closable:!1,"show-icon":""},null,8,["title"])):(0,l.kq)("",!0),(0,l.wy)(((0,l.wg)(),(0,l.j4)(P,{key:g.tableKey,data:g.dataList,"element-loading-text":"给我一点时间",fit:"","highlight-current-row":"",style:{width:"100%"},border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{align:"center",label:"序号"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.id),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"企业编号"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.number),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"企业简称"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.shortName),1)])),_:1}),(0,l.Wm)(q,{label:"标签"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.tags),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"创建者"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.creatorID),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"创建日期"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.addDate),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"备注"},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,s.zw)(e.row.remarks),1)])),_:1}),(0,l.Wm)(q,{align:"center",label:"状态"},{default:(0,l.w5)((e=>[1==e.row.state?((0,l.wg)(),(0,l.iD)("span",u,"启用")):((0,l.wg)(),(0,l.iD)("span",m,"禁用"))])),_:1}),(0,l.Wm)(q,{align:"center",label:"操作",width:"280","class-name":"small-padding fixed-width"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,{type:"primary",size:"mini",onClick:t=>w.handleChange(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Uk)("编辑")])),_:2},1032,["onClick"]),(0,l.Wm)(k,{type:"primary",size:"mini",onClick:t=>w.handleStatus(e.row)},{default:(0,l.w5)((()=>[0==e.row.state?((0,l.wg)(),(0,l.iD)("span",d,"启用")):((0,l.wg)(),(0,l.iD)("span",c,"禁用"))])),_:2},1032,["onClick"]),"deleted"!=e.row.status?((0,l.wg)(),(0,l.j4)(k,{key:0,size:"mini",type:"danger",onClick:t=>w.removeUser(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["data"])),[[B,g.listLoading]]),(0,l._)("div",p,[(0,l._)("div",h,[(0,l.Wm)(F,{background:"",onSizeChange:w.handleSizeChange,onCurrentChange:w.handleCurrentChange,"current-page":Number(g.requestParameters.page),total:Number(g.total),"page-size":Number(g.requestParameters.pagesize),"page-sizes":[10,20,30,50],layout:"sizes, prev, pager, next, jumper"},null,8,["onSizeChange","onCurrentChange","current-page","total","page-size"])])]),(0,l.Wm)(z,{ref:"editUser",titleInfo:g.titleInfo,formBase:g.formData,onNewDataes:w.getList},null,8,["titleInfo","formBase","onNewDataes"])])),_:1})])])}var g=a(72748);const w=[{value:1,label:"启用"},{value:0,label:"禁用"}];var y=a(84471);const b=e=>(0,y.r)("/companys","get",e),_=e=>(0,y.r)(`/companys/${e.id}`,"delete",e),v=e=>(0,y.r)(`/companys/${e.id}`,"get",e),W=e=>(0,y.r)(`/companys/${e.id}/state`,"post",e);var k=a(25732),D=a(18483),V={data(){return{tableKey:0,dataList:[],total:null,listLoading:!0,alertText:"",requestParameters:{page:1,pagesize:10},titleInfo:{pageTitle:"用户",text:""},formData:{isFamous:"",shortName:"",company:"",province:"",city:"",tags:"",remarks:""},citySelect:{province:[],cityDate:[]},ElIconSearch:g.Search,ElIconEdit:g.Edit}},name:"CompanysList",components:{Dialog:D["default"]},computed:{status(){return w}},methods:{initialDate(){this.getList()},async getList(e){this.listLoading=!0;const{data:t}=await b(this.requestParameters);this.dataList=t.items,this.total=t.counts,this.alertText=`共 ${this.total} 条记录`,this.listLoading=!1},resetForm(){this.$refs.requestParameters.resetFields()},handleFilter(){this.requestParameters.page=1,this.getList(this.requestParameters)},handleSizeChange(e){this.requestParameters.pagesize=e,1===this.requestParameters.page&&this.getList(this.requestParameters)},handleCurrentChange(e){this.requestParameters.page=e,this.getList()},query(){this.formData={}},handleChange(e){this.query(),this.$refs.editUser.dialogFormV(),"add"===e?this.titleInfo.text="创建":(this.titleInfo.text="编辑",this.hanldeEditForm(e))},async hanldeEditForm(e){this.formData.id=e;const{data:t}=await v({id:e});this.formData=t},removeUser(e){this.$confirm("此操作将永久删除用户 , 是否继续?","提示",{type:"warning"}).then((async()=>{await _({id:e}).then((t=>{this.$message.success("成功删除了用户!"),this.dataList.splice(e,1),this.getList(this.requestParameters)})).catch((e=>{this.$message.error("删除失败!")}))})).catch((()=>{this.$message.info("已取消操作!")}))},handleStatus(e){let t="";!0===e.state?(e.state=0,t="禁用"):(e.state=1,t="启用");const a={id:e.id,state:e.state};this.$confirm("已成功"+t+", 是否继续?","提示",{type:"warning"}).then((async()=>{await W(a).then((e=>{this.$message.success("已成功"+t+"!"),this.getList(this.requestParameters)})).catch((e=>{this.$message.error(t+"失败!")}))})).catch((()=>{this.$message.info("已取消操作!")}))},getCityData:function(){this.citySelect.province=(0,k.J)()},handleProvince:function(e){this.citySelect.cityDate=(0,k.s)(e),this.requestParameters.city=this.citySelect.cityDate[0]}},mounted:function(){},created(){const e=this;this.initialDate(),this.getCityData(),document.onkeydown=function(t){const a=window.event.keyCode;13===a&&e.handleFilter(this.requestParameters)}},updated:function(){}},C=a(40089);const q=(0,C.Z)(V,[["render",f],["__scopeId","data-v-43b22a6e"]]);var P=q}}]);
//# sourceMappingURL=578.741e8953.js.map