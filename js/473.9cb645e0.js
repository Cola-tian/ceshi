"use strict";(self["webpackChunkhmmm_frontend_vue3_dev"]=self["webpackChunkhmmm_frontend_vue3_dev"]||[]).push([[473],{8720:function(e,t,s){s.d(t,{IH:function(){return r},Od:function(){return d},Vx:function(){return l},lA:function(){return a},lC:function(){return n},pb:function(){return o}});var i=s(84471);const o=e=>(0,i.r)("/permissions","get",e),n=e=>(0,i.r)("/permissions/simple","get",e),r=e=>(0,i.r)("/permissions","post",e),l=e=>(0,i.r)(`/permissions/${e.id}`,"put",e),d=e=>(0,i.r)(`/permissions/${e.id}`,"delete",e),a=e=>(0,i.r)(`/permissions/${e.id}`,"get",e)},39473:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var i=s(73396),o=s(87139);const n={class:"add-form"},r={class:"dialog-footer"};function l(e,t,s,l,d,a){const m=(0,i.up)("el-input"),h=(0,i.up)("el-form-item"),u=(0,i.up)("el-tree"),c=(0,i.up)("el-form"),f=(0,i.up)("el-button"),p=(0,i.up)("el-dialog");return(0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(p,{title:s.text+s.pageTitle,modelValue:d.dialogFormVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>d.dialogFormVisible=e)},{footer:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i.Wm)(f,{onClick:a.handleClose},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("table.cancel")),1)])),_:1},8,["onClick"]),(0,i.Wm)(f,{type:"primary",onClick:t[1]||(t[1]=e=>a.handleAdd("formBase"))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("table.confirm")),1)])),_:1})])])),default:(0,i.w5)((()=>[(0,i.Wm)(c,{rules:s.ruleInline,ref:"dataForm",model:d.formBase,"label-position":"left","label-width":"120px",style:{width:"400px","margin-left":"120px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:e.$t("table.username"),prop:"title"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{modelValue:d.formBase.title,"onUpdate:modelValue":t[0]||(t[0]=e=>d.formBase.title=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,i.Wm)(h,{label:e.$t("table.powerDistriB")},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{ref:"treeMenu",data:a.treeData,"show-checkbox":"","node-key":"id","default-expanded-keys":[0],"default-checked-keys":d.formBase.permissions,props:d.defaultProps,onCheck:a.handleCheckChange},null,8,["data","default-checked-keys","props","onCheck"])])),_:1},8,["label"])])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])])}s(57658);var d=s(19471),a=s(8720),m=s(5917);let h=[];var u={name:"usersAdd",props:["text","pageTitle","ruleInline"],data(){return{dialogFormVisible:!1,PermissionGroupsmenu:[],defaultProps:{label:"title"},permissions:[],treeCheckedNodes:[],formBase:{id:0,create_date:"",title:"",permissions:[]},curPermissions:[]}},computed:{treeData(){function e(e){let t=!1,s=!1;if(null!==h&&h.formBase.permissions.length>0){const t=h.formBase.permissions.find((function(t,s){return t===e.id}));s=!!t}if(s){const s=void 0===e.childs&&void 0===e.points,i=void 0!==e.childs&&e.childs.length>0,o=void 0!==e.points&&e.points.length>0;t=!!s||!o&&!i}return{id:void 0===e.id?0:e.id,title:e.title,children:[],selected:s,checked:t}}function t(s,i){for(const o of s){const s=e(o);s.checked&&(i.selected=!0),void 0!==o.childs&&o.childs.length>0?t(o.childs,s):void 0!==o.points&&o.points.length>0&&t(o.points,s),i.children.push(s)}}const s=e({title:"系统菜单和页面权限点",expand:!0});return t(this.PermissionGroupsmenu,s),[s]}},methods:{dialogFormV(){this.dialogFormVisible=!0},dialogFormH(){this.dialogFormVisible=!1},handleClose(){(0,d.Qy)(this,"handleCloseModal")},handleResetForm(){this.formBase={id:0,title:"",permissions:[]}},hanldeEditForm(e){this.formBase.id=e;const t={id:e};(0,a.lA)(t).then(((e,t)=>{if(t)return t;this.formBase.id=e.data.id,this.formBase.title=e.data.title,this.formBase.permissions=e.data.permissions}))},setupData(){(0,m.pb)().then((e=>{this.PermissionGroupsmenu=e.data}))},handleCheckChange(e,t,s){this.treeCheckedNodes=t.checkedNodes},handleAdd(e){const t=new Set;if(0!==this.treeCheckedNodes.length||(this.treeCheckedNodes=this.$refs.treeMenu.getCheckedNodes(),0!==this.treeCheckedNodes.length)){for(const e of this.treeCheckedNodes)t.add(e.id);this.curPermissions=Array.from(t),0===this.curPermissions.length?this.$message({showClose:!0,message:"请选择需要的权限及页面权限点",type:"error"}):this.dataFormSub(this.curPermissions)}},nodeDate(e,t,s){e.forEach((function(e,i){-1===t.indexOf(e.id)&&t.push(s)}))},dataFormSub(e){this.$refs.dataForm.validate((t=>{if(t)if((0,d.Qy)(this,"handleCloseModal"),h.formBase.id){const t={id:this.formBase.id,title:this.formBase.title,permissions:e};(0,a.Vx)(t).then((()=>{(0,d.Qy)(this,"newDataes",this.formBase)}))}else(0,a.IH)({title:this.formBase.title,permissions:e}).then((()=>{(0,d.Qy)(this,"newDataes",this.formBase)}));else this.$Message.error("*号为必填项!")}))}},mounted:function(){},created(){h=this,this.setupData()},updated:function(){},emits:["newDataes","handleCloseModal"]},c=s(40089);const f=(0,c.Z)(u,[["render",l]]);var p=f}}]);
//# sourceMappingURL=473.9cb645e0.js.map