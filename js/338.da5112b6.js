"use strict";(self["webpackChunkhmmm_frontend_vue3_dev"]=self["webpackChunkhmmm_frontend_vue3_dev"]||[]).push([[338],{71095:function(e,t,o){o(57658);function l(e){if(!(this instanceof l))return new l(e,null,null)}l.treeToArray=function(e,t,o,i){let a=[];return Array.from(e).forEach((function(e){void 0===e._expanded&&(e._expanded=i),t&&(e._parent=t);let n=0;if(void 0!==o&&null!==o&&(n=o+1),e._level=n,a.push(e),e.childs&&e.childs.length>0){const t=l.treeToArray(e.childs,e,n,i);a=a.concat(t)}if(e.points&&e.points.length>0){const t=l.treeToArray(e.points,e,n,i);a=a.concat(t)}})),a},t.Z=l},31338:function(e,t,o){o.r(t),o.d(t,{default:function(){return g}});var l=o(73396),i=o(87139);const a={class:"add-form"},n={key:0},d=["model"],s={class:"dialog-footer"};function r(e,t,o,r,u,m){const h=(0,l.up)("el-radio"),p=(0,l.up)("el-radio-group"),c=(0,l.up)("el-form-item"),f=(0,l.up)("el-option"),g=(0,l.up)("el-select"),M=(0,l.up)("el-input"),b=(0,l.up)("el-form"),y=(0,l.up)("el-button"),w=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l.Wm)(w,{title:o.text+o.pageTitle,modelValue:u.dialogFormVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>u.dialogFormVisible=e)},{footer:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(y,{onClick:m.handleClose},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.$t("table.cancel")),1)])),_:1},8,["onClick"]),(0,l.Wm)(y,{type:"primary",onClick:t[6]||(t[6]=e=>m.handleSubmit("formMenu"))},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.$t("table.confirm")),1)])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(b,{rules:u.ruleInline,ref:"formMenu",model:u.formMenu,"label-position":"left","label-width":"120px",style:{width:"400px","margin-left":"120px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:e.$t("table.permissionUser")},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:u.type,"onUpdate:modelValue":t[0]||(t[0]=e=>u.type=e),class:"choose-type",onChange:m.handleChooseType},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"menu",class:"choose-item",disabled:u.typeStatus},{default:(0,l.w5)((()=>[(0,l.Uk)("菜单")])),_:1},8,["disabled"]),(0,l.Wm)(h,{label:"points",class:"choose-item",disabled:u.typeStatus},{default:(0,l.w5)((()=>[(0,l.Uk)("权限点")])),_:1},8,["disabled"])])),_:1},8,["modelValue","onChange"])])),_:1},8,["label"]),(0,l.Wm)(c,{label:e.$t("table.permissionUser")},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:u.formMenu.pid,"onUpdate:modelValue":t[1]||(t[1]=e=>u.formMenu.pid=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{value:0,label:e.$t("table.powerNav")},{default:(0,l.w5)((()=>[(0,l.Uk)("主导航")])),_:1},8,["label"]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.notPointDataList,(e=>((0,l.wg)(),(0,l.j4)(f,{value:e.id,key:e.id,label:e.title,disabled:"points"===u.type&&!!e.childs,class:(0,i.C_)("moveIn"+e.layer)},null,8,["value","label","disabled","class"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),u.showMenuBlock?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(c,{label:e.$t("table.powerCode"),prop:"code"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{modelValue:u.formMenu.code,"onUpdate:modelValue":t[2]||(t[2]=e=>u.formMenu.code=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,l.Wm)(c,{label:e.$t("table.powerTitle"),prop:"title"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{modelValue:u.formMenu.title,"onUpdate:modelValue":t[3]||(t[3]=e=>u.formMenu.title=e)},null,8,["modelValue"])])),_:1},8,["label"])])):(0,l.kq)("",!0),u.showPointBlock?((0,l.wg)(),(0,l.iD)("div",{key:1,model:u.formPoints},[(0,l.Wm)(c,{label:e.$t("table.powerCode"),prop:"code"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{modelValue:u.formPoints.code,"onUpdate:modelValue":t[4]||(t[4]=e=>u.formPoints.code=e)},null,8,["modelValue"])])),_:1},8,["label"]),(0,l.Wm)(c,{label:e.$t("table.powerTitle"),prop:"title"},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{modelValue:u.formPoints.title,"onUpdate:modelValue":t[5]||(t[5]=e=>u.formPoints.title=e)},null,8,["modelValue"])])),_:1},8,["label"])],8,d)):(0,l.kq)("",!0)])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue"])])}o(57658);var u=o(19471),m=o(5917);o(71095);let h=[];var p={name:"items",props:{treeStructure:{type:Boolean,default:function(){return!1}},text:{type:String},pageTitle:{type:String},PermissionGroupsList:{type:Array}},data(){const e=(t,o,l)=>{const i=h.formMenu.code;if(""===o)l(new Error("代码不能为空"));else{e.ifHave=!1;const t=h.formMenu.pid;e.ifHaveCodeExciting=function(o){for(let l=0;l<o.length;l++)o[l].childs&&o[l].childs.length>0&&e.ifHaveCodeExciting(o[l].childs),o[l].points&&o[l].points.length>0&&o[l].id===t&&e.doPoints(o[l].points)},e.doPoints=function(t){for(let o=0;o<t.length;o++)t[o].code&&t[o].code===i&&(e.ifHave=!0)},e.ifHaveCodeExciting(h.parentDataList),l()}};return{type:"menu",showMenuBlock:!0,showPointBlock:!1,dialogFormVisible:!1,typeStatus:!1,notPointDataList:[],parentDataList:[],formMenu:{pid:"",is_point:"",code:"",title:""},formPoints:{pid:"",is_point:"",code:"",title:""},codepast:"",ruleInline:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],code:[{required:!0,validator:e,trigger:"blur"}]},leafCount:[]}},computed:{},methods:{dialogFormV(){this.dialogFormVisible=!0},dialogFormH(){this.dialogFormVisible=!1},handleChooseType(){"menu"===this.type&&h.changeToMenu(),"points"===this.type&&h.changeToPoints()},changeType(e){"menu"===e&&(this.type="menu",h.changeToMenu()),"points"===e&&(this.type="points",h.changeToPoints()),this.typeStatus=!0},changeArays(){const e=t=>{for(let o=0;o<t.length;o++)void 0!==t[o].code&&h.notPointDataList.push(t[o]),t[o].childs&&t[o].childs.length>0&&e(t[o].childs)};e(h.parentDataList)},changeToMenu(){h.showMenuBlock=!0,h.showPointBlock=!1,h.notPointDataList=[],this.changeArays()},changeToPoints(){h.showMenuBlock=!1,h.showPointBlock=!0,h.formMenu=h.formPoints,h.formMenu.pid=h.formPoints.pid,h.formMenu.code=h.formPoints.code,h.formMenu.title=h.formPoints.title,h.notPointDataList=[],this.changeArays()},handleClose(){(0,u.Qy)(this,"handleCloseModal")},handle_Edit(e){(0,m.Vx)(this.formMenu).then((()=>{(0,u.Qy)(this,"handleCloseModal"),(0,u.Qy)(this,"newDataes",this.formMenu)}))},select_Add(){(0,m.IH)(this.formMenu).then((()=>{h.handleResetForm(),(0,u.Qy)(this,"handleCloseModal"),(0,u.Qy)(this,"newDataes",this.formMenu)}))},handle_Add(e){"points"===h.type?(this.formMenu.is_point=!0,this.select_Add()):(this.formMenu.is_point=!1,this.select_Add())},handleSubmit(e){if(h.formMenu.pid=Number(h.formMenu.pid),h.formMenu.id){const t=h.formMenu.code;t===this.codepast?(this.$refs.formMenu.validateField("title"),h.handle_Edit(e)):h.$refs[e].validate((t=>{t?h.handle_Edit(e):this.$Message.error("表单验证失败")}))}else h.$refs[e].validate((t=>{t?h.handle_Add(e):this.$Message.error("表单验证失败")}))},dataRest(e){for(let t=0;t<e.length;t++){if(e[t].childs&&e[t].childs.length>0)for(let o=0;o<e[t].childs.length;o++)e[t].childs[o].layer=1;e[t].layer=0}},hanldeEditForm(e){this.formMenu.id=e,(0,m.pb)().then((e=>{h.parentDataList=e.data,h.notPointDataList=[],this.dataRest(e.data),this.changeArays()})),(0,m.lA)({id:e}).then((e=>{this.formMenu.id=e.data.id,this.formMenu.pid=e.data.pid,this.formMenu.title=e.data.title,this.formMenu.code=e.data.code,this.formMenu.is_point=e.data.is_point;const t=e.data,o=this.type;"points"===o&&(this.formMenu.code=e.data.code),null===t.pid&&(this.formMenu.pid=0)}))},handleResetForm(){this.formMenu.id="",this.formMenu.pid=0,this.formMenu.title="",this.formMenu.code="",h.typeStatus=!1,h.type="menu",(0,m.pb)().then((e=>{h.parentDataList=e.data,h.notPointDataList=h.parentDataList,this.dataRest(e.data),h.changeToMenu()}))}},mounted:function(){},created(){h=this},updated:function(){},emits:["newDataes","handleCloseModal"]},c=o(40089);const f=(0,c.Z)(p,[["render",r],["__scopeId","data-v-70010ac8"]]);var g=f}}]);
//# sourceMappingURL=338.da5112b6.js.map